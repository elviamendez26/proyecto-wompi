<div class="grid grid-cols-1" *ngIf="mostrarpago==true">
    <div>
        <h2 class="">Pagar tu crédito</h2>
        <mat-stepper orientation="vertical" [linear]="true" #stepper>
            <mat-step [stepControl]="formularioPagos">
                <ng-template matStepLabel>Selecciona el documento</ng-template>
                <div class="subtitule">
                    Ingresa el número de identificación del TITULAR.
                </div>
                <form novalidate [formGroup]="formularioPagos">
                    <div class="grid sm:grid-cols-2 grid-cols-1 gap-3">
                        <mat-form-field appearance="fill">
                            <mat-label>Tipo de documento</mat-label>
                            <mat-select formControlName="tipo">
                                <mat-option value="CC">CEDULA</mat-option>
                                <mat-option value="NIT">NIT</mat-option>
                            </mat-select>
                        </mat-form-field>
                        <mat-form-field appearance="fill" class="m-0">
                            <mat-label>Número de documento</mat-label>
                            <input matInput #input formControlName="numeroDoc" maxlength="10" minlength="5"
                                placeholder="" autocomplete="off">
                        </mat-form-field>
                    </div>
                    <div>
                        <button [disabled]="formularioPagos.invalid" mat-stroked-button color="primary"
                            (click)="enviarDatos()" matStepperNext>Buscar</button>
                    </div>
                </form>
            </mat-step>
            <mat-step [stepControl]="formularioFactura">
                <ng-template matStepLabel>Listado de factura</ng-template>

                <div class="subtitule">
                    <mat-icon class="icono"> business</mat-icon>
                    <div class="texto">
                        {{TipoIdentificacion}} {{identificacion}}
                        <br>
                        <strong>{{nombreCliente}}</strong>
                    </div>
                </div>
                <div class="responsive hidden md:block">
                    <table class=" w-full text-sm text-left text-gray-500 dark:text-gray-400 ">
                        <thead class="text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400">
                            <tr>
                                <th scope="col" class="py-3 px-6">

                                </th>
                                <th scope="col" class="py-3 px-6">
                                    Número de factura
                                </th>
                                <th scope="col" class="py-3 px-6">
                                    Fecha vencimiento
                                </th>
                                <th scope="col" class="py-3 px-6">
                                    Pagar
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="bg-white border-b dark:bg-gray-800 dark:border-gray-700"
                                *ngFor="let dato of datoPagar">
                                <td scope="row"
                                    class="py-4 px-6 font-medium text-gray-900 whitespace-nowrap dark:text-white">
                                    <mat-checkbox class="example-margin" (change)="almacenarDato(dato,$event)"
                                        [(ngModel)]="dato.checked"></mat-checkbox>
                                </td>
                                <td class="py-4 px-6">
                                    {{dato.numeroFactura}}
                                </td>
                                <td class="py-4 px-6">
                                    {{dato.fechaVencimiento}}
                                </td>
                                <td class="py-4 px-6">
                                    ${{dato.valorFactura | number}}
                                </td>

                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="responsive block md:hidden">
                    <table class=" w-full text-sm text-left text-gray-500 dark:text-gray-400 ">

                        <tbody>
                            <ng-container *ngFor="let dato of datoPagar">
                                <tr>
                                    <td scope="row" rowspan="2"
                                        class="py-4 px-6 font-medium text-gray-900 whitespace-nowrap dark:text-white">
                                        <mat-checkbox class="example-margin" (change)="almacenarDato(dato,$event)"
                                            [(ngModel)]="dato.checked"></mat-checkbox>
                                    </td>
                                </tr>
                                <tr class="bg-white dark:bg-gray-800 dark:border-gray-700">

                                    <td class="py-4 px-6" colspan="2">
                                        {{dato.numeroFactura}}
                                    </td>
                                </tr>
                                <tr class="bg-white border-b dark:bg-gray-800 dark:border-gray-700">
                                    <td class="py-4 px-6">
                                        {{dato.fechaVencimiento}}
                                    </td>
                                    <td class="py-4 px-6">
                                        ${{dato.valorFactura | number}}
                                    </td>

                                </tr>
                            </ng-container>

                        </tbody>
                    </table>
                </div>


                <div class="mt-3 flex sm:justify-end">

                    <div class="total">
                        <mat-icon class="icono">attach_money</mat-icon>
                        <div class="texto">
                            Total seleccionado
                            <br>
                            <strong>${{sumTotal|number}}</strong>
                        </div>
                    </div>

                </div>

                <div>
                    <button mat-button matStepperPrevious>Atras</button>

                    <button [disabled]="formularioFactura.invalid" mat-stroked-button color="primary"
                        (click)="referenciaPago()" matStepperNext>Pagar </button>
                </div>
            </mat-step>
            <mat-step>
                <ng-template matStepLabel>Elegir forma de pago</ng-template>
                <div class="subtitule">
                    <mat-icon class="icono"> business</mat-icon>
                    <div class="texto">
                        {{TipoIdentificacion}} {{identificacion}}
                        <br>
                        <strong>{{nombreCliente}}</strong>
                    </div>
                </div>




                <mat-accordion>
                    <mat-expansion-panel hideToggle>
                        <mat-expansion-panel-header>
                            <mat-panel-title>
                                Pagos en linea
                            </mat-panel-title>
                        </mat-expansion-panel-header>
                        <div class="flex gap-3">
                            <mat-radio-group aria-label="Select an option" [(ngModel)]="metodoPago">
                                <ng-container *ngFor="let item of configuracionPasarela">
                                    <mat-radio-button class=" ml-3" [value]="item.codigo" *ngIf="item.aplicaPagoOnline">
                                        <mat-card class="example-card">
                                            <img class="imagenLogo" src="assets/{{item.entidad}}.png"
                                                [alt]="item.entidad">
                                            <mat-card-content>
                                                <h6>
                                                    Costos <strong>{{item.valorTarifa | number}}</strong>
                                                    <br>
                                                    valor min <strong>{{item.valorMinimo | number}}</strong>
                                                    <br>
                                                    valor max <strong>{{item.valorMaximo | number}}</strong>
                                                </h6>
                                            </mat-card-content>
                                        </mat-card>
                                    </mat-radio-button>
                                </ng-container>
                            </mat-radio-group>
                        </div>
                    </mat-expansion-panel>
                    <mat-expansion-panel (opened)="panelOpenState = true" (closed)="panelOpenState = false">
                        <mat-expansion-panel-header>
                            <mat-panel-title>
                                Pagos en efectivo
                            </mat-panel-title>
                        </mat-expansion-panel-header>
                        <div class="flex gap-3">
                            <mat-radio-group aria-label="Select an option" [(ngModel)]="metodoPago">
                                <ng-container *ngFor="let item of configuracionPasarela">
                                    <mat-radio-button class=" ml-3" [value]="item.codigo"
                                        *ngIf="!item.aplicaPagoOnline">
                                        <mat-card class="example-card">
                                            <img class="imagenLogo" src="assets/{{item.entidad}}.png"
                                                [alt]="item.entidad">
                                            <mat-card-content>
                                                <h6>
                                                    Costos <strong>{{item.valorTarifa | number}}</strong>
                                                    <br>
                                                    valor min <strong>{{item.valorMinimo | number}}</strong>
                                                    <br>
                                                    valor max <strong>{{item.valorMaximo | number}}</strong>
                                                </h6>
                                            </mat-card-content>
                                        </mat-card>
                                    </mat-radio-button>
                                </ng-container>
                            </mat-radio-group>
                        </div>
                    </mat-expansion-panel>
                </mat-accordion>




                <div class="mt-3">
                    <button mat-button matStepperPrevious>Volver</button>
                    <!-- <button mat-button (click)="stepper.reset()"  [disabled]="formularioPagos.invalid">Pagar</button> -->
                    <button [disabled]="formularioPagos.invalid" mat-stroked-button color="primary"
                        (click)="pagar()">Pagar</button>
                </div>
            </mat-step>
        </mat-stepper>
    </div>
</div>
<iframe width="100%" height="100%" *ngIf="mostrarpago==false" frameBorder="0" [src]="safeSrc"></iframe>